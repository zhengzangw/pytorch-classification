# @package _global_

defaults:
  - nersc_gta5_cityscapes_ssl
  - override /scheduler: none

load_from_checkpoint: "/global/cfs/cdirs/m3691/zangwei/pytorch-classification/logs/runs/2021-09-12/08-46-31/checkpoints/epoch79-val_IoU0.42.ckpt"

trainer:
  gpus: 4
  max_epochs: 40

ssl:
  classwise_sample: True
  continual_clustering: False
  sample_ratio: 0.01
  proto_freq: 0.33
  queue_size: 1250000 # 2500 * 500

  k: [19, 38]
  k_rep: [5, 5]
  phi: 0.05

optimizer:
  lr: 2.5e-4
